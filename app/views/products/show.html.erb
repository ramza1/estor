<% content_for :head do -%>
    <%= stylesheet_link_tag 'pikachoose_product.css' %>
<% end %>

<%= content_for :product do %>
    <div class="row-fluid">
    <div class="span5">
      <ul class="thumbnails mainimage">
        <% if @product.hero_variant.low_stock? %>
            <%= image_tag("ribbons/#{@product.hero_variant.stock_status}.png",
                          :width => 63, :height => 62,
                          :style => 'border:none;',
                          :class => 'upper_left_overlay'
                ) %>
        <% end %>
        <% if @product.images.size == 1 %>
            <ul>
              <% @product.images.each do |image|%>
                  <li>
                    <a><%= image_tag(image.photo.url(:large)) %></a>
                  </li>
              <% end %>
            </ul>
        <% elsif @product.images.size == 0 %>
            <ul>
              <li>
                <a><%= image_tag(@product.featured_image(:large)) %></a>
              </li>
            </ul>
        <% else %>
            <ul id="pikame" class="jcarousel-skin-pika row-fluid" style="margin-top: 5px;">
              <% @product.images.each do |image|%>
                  <li class="span3">
                    <a><%= image_tag(image.photo.url(:large)) %></a>
                  </li>
              <% end %>
            </ul>
        <% end %>
      </ul>

    </div>
    <div class="span7">
          <div class=' clearfix'>
            <% if @product.active_variants.empty? %>
                <div id='no-variant-available' class=' four large-4 last'>
                  Sorry this product is not currently available.
                </div>
            <% else %>

                <div id='left_product_wrapper' class='columns five large-5'>
                  <!-- <ul class='horizontal-list'>
            <li><%= link_to 'Share', '#share-product', :class => 'button small share' %></li>
          </ul> -->
                </div>
                <div id='right_2_product_wrapper' class='six columns large-6 last'>
                  <div id='right_product_wrapper' class=''>
                    <div class='product_title_name'><%= @product.name.titleize %></div>
                    <% if @product.active_variants.count > 0 %>
                        <div class='product_content'>
                          <div class='product_content_price'>
                            <%= number_to_currency @product.active_variants.first.price %>
                          </div>

                        </div>
                        <div id='your_product' class='panel'>
                          <% @product.active_variants.each_with_index do |variant, i| %>
                              <div id='variant_<%= variant.id %>'
                                   class='tiny btn variant_select secondary <%= 'selected_variant btn-success' if i == 0 %>'
                                   data-variant_id='<%= variant.id %>'>
                                <%= raw variant.product_name %>
                              </div>
                          <% end %>
                          <div  class='properties_inner_wrapper ' >
                            <%= form_for  @cart_item,
                                          :url  => shopping_cart_items_path(@cart_item),
                                          :html => { :id => 'new_cart_item', :class => 'custom form-inline quantitybox' } do |f| %>
                                <%= f.hidden_field :variant_id %>

                                  Quantity: <br/>
                                <%= f.select :quantity, [1,2,3,4], {:include_blank => false}, {:class => ' '} %>

                                  <% unless @product.active_variants.empty? %>
                                      <%= link_to '#', :id => 'submit_add_to_cart', :class => 'small btn' do %>
                                        <i class="carticon"></i>  Add to Cart
                                       <% end %>
                                  <% end %>
                            <% end %>
                          </div>
                          <div  class='clearfix' style='margin-bottom:20px;' >&nbsp;</div>
                        </div>

                        <div class="productdesc">
                          <ul class="nav nav-tabs" id="myTab">
                            <li class="active"><a href="#description">Product</a>
                            </li>
                            <li><a href="#specification">Properties</a>
                            </li>
                          </ul>
                          <div class="tab-content">
                            <div class="tab-pane active" id="description">
                              <%= raw @product.description %>
                            </div>
                            <div class="tab-pane " id="specification">
                              <% @product.active_variants.each_with_index do |var, i| %>
                                  <div id='variant_properties_<%= var.id %>' class='variant_properties <%= 'selected' if i == 0 %>'>
                                    <ul class='vertical-list'>
                                      <% var.variant_properties.each do |prop| %>
                                          <li><label><%= prop.property_name %>:</label>  <%= prop.description %></li>
                                      <% end %>
                                    </ul>
                                  </div>
                              <% end %>
                            </div>
                          </div>
                        </div>

                    <% end %>
                  </div>
                </div>
                </div>
    </div>
</div>

      <%#= render "related_products" %>

<% end %>
<% end %>


<% content_for :bottom do -%>
    <%= javascript_include_tag 'shopping/cart.js' %>
    <%= javascript_include_tag 'jquery.jcarousel.js' %>
    <%= javascript_include_tag 'jquery.pikachoose.full.js' %>

    <% if @product.images.size > 1 %>
        <script>
            $(document).ready(function (){
                $("#pikame").PikaChoose({autoPlay:true, carousel:false, carouselVertical:false});
                $('#pikame').data('pikachoose').Pause();
            });
        </script>
    <% end %>
    <%#= javascript_include_tag 'product_page.js' %>
<% end %>

